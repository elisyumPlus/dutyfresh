<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Restoran Kayıt Takip Sistemi</title>
<!-- Google Fonts Montserrat ekleme -->
<link href="https://fonts.googleapis.com/css2?family=Montserrat&display=swap" rel="stylesheet" />
<style>
  body { 
    font-family: 'Montserrat', sans-serif; 
    background: linear-gradient(135deg, #4b0082, #000000);
    color:#fff; 
    padding:20px; 
    min-height: 100vh;
  }
  h2, h3 { text-shadow: 1px 1px 4px rgba(0,0,0,0.4); }
  input, button { 
    padding:10px; 
    margin:5px; 
    border-radius:5px; 
    border:none; 
    outline:none; 
    box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    font-family: 'Montserrat', sans-serif;
  }
  button { 
    cursor:pointer; 
    background: #ffffff; 
    color: #4b0082; 
    border: 2px solid #ffffff; 
    transition:0.3s; 
  }
  button:hover { 
    filter: brightness(1.1); 
    box-shadow: 0 4px 8px rgba(0,0,0,0.3); 
  }
  .kirmizi { background-color: #d9534f; }
  table { 
    width:100%; 
    border-collapse:collapse; 
    margin-top:20px; 
    box-shadow: 0 4px 8px rgba(0,0,0,0.2); 
  }
  th, td { padding:8px; text-align:left; }
  th { background: rgba(255,255,255,0.2); }
  tbody tr:hover { background: rgba(255,255,255,0.3); }
  .filtre-input { margin-top: 10px; }
</style>
</head>
<body>

<h2>Restoran Kayıt Takip Sistemi</h2>

<h3>Kayıt Ekle</h3>
<input type="text" id="isim" placeholder="İsim" />
<input type="text" id="tür" placeholder="Tür" />
<input type="number" id="stok" placeholder="Stok" />
<button onclick="kayıtEkle()">Ekle</button>

<h3>Filtrele</h3>
<div class="filtre-input">
  <input type="text" id="filtreIsim" placeholder="İsime Göre Filtre" onkeyup="filtrele()" />
  <input type="text" id="filtreTür" placeholder="Türe Göre Filtre" onkeyup="filtrele()" />
  <input type="date" id="filtreTarih" placeholder="Tarihe Göre" onchange="filtrele()" />
</div>

<h3>Kayıtlar</h3>
<table>
  <thead>
    <tr>
      <th>İsim</th>
      <th>Tür</th>
      <th>Stok</th>
      <th>Stok Geliş</th>
      <th>Giriş Tarihi</th>
      <th>Bitiş Tarihi</th>
      <th>İşlemler</th>
    </tr>
  </thead>
  <tbody id="kayıtlarBody"></tbody>
</table>

<script>
  let kayıtlar = [];

  function başlangıç() {
    const stored = localStorage.getItem('kayıtlar');
    if (stored) {
      kayıtlar = JSON.parse(stored);
    } else {
      kayıtlar = [
        { isim: "Elma", tür: "Meyve", stok: 50, girisTarihi: "", bitisTarihi: "" },
        { isim: "Ekmek", tür: "Gıda", stok: 30, girisTarihi: "", bitisTarihi: "" }
      ];
      localStorage.setItem('kayıtlar', JSON.stringify(kayıtlar));
    }
    göster();
  }

  function göster(filteredKayıtlar = null) {
    const tbody = document.getElementById('kayıtlarBody');
    tbody.innerHTML = '';
    const list = filteredKayıtlar || kayıtlar;
    list.forEach((k, i) => {
      const row = tbody.insertRow();
      row.insertCell().innerText = k.isim;
      row.insertCell().innerText = k.tür;
      row.insertCell().innerText = k.stok;
      row.insertCell().innerText = k.stokGelis || '';
      row.insertCell().innerText = k.girisTarihi;
      row.insertCell().innerText = k.bitisTarihi;

      const işlemler = row.insertCell();

      // Sil butonu
      const silBtn = document.createElement('button');
      silBtn.innerText = 'Sil';
      silBtn.onclick = () => {
        kayıtlar.splice(i,1);
        localStorage.setItem('kayıtlar', JSON.stringify(kayıtlar));
        filtrele(); // filtreyle tekrar göster
      };
      işlemler.appendChild(silBtn);

      // Stok Güncelle
      const güncelleBtn = document.createElement('button');
      güncelleBtn.innerText = 'Stok Güncelle';
      güncelleBtn.onclick = () => {
        const yeniStok = prompt('Yeni stok miktarını girin:', k.stok);
        if (yeniStok !== null) {
          const sayi = parseInt(yeniStok);
          if (!isNaN(sayi)) {
            kayıtlar[i].stok = sayi;
            localStorage.setItem('kayıtlar', JSON.stringify(kayıtlar));
            filtrele();
          } else {
            alert('Geçersiz sayı!');
          }
        }
      };
      işlemler.appendChild(güncelleBtn);

      // Stok Bitti Butonu
      const stokBittiBtn = document.createElement('button');
      stokBittiBtn.innerText = 'Stok Bitti';
      stokBittiBtn.className = 'kirmizi';
      stokBittiBtn.onclick = () => {
        kayıtlar[i].stok = 0;
        const bugun = new Date();
        const gun = bugun.getDate().toString().padStart(2,'0');
        const ay = (bugun.getMonth()+1).toString().padStart(2,'0');
        const yil = bugun.getFullYear();
        kayıtlar[i].bitisTarihi = `${yil}-${ay}-${gun}`;
        localStorage.setItem('kayıtlar', JSON.stringify(kayıtlar));
        filtrele();
      };
      işlemler.appendChild(stokBittiBtn);
    });
  }

  function kayıtEkle() {
    const isim = document.getElementById('isim').value.trim();
    const tür = document.getElementById('tür').value.trim();
    const stok = parseInt(document.getElementById('stok').value);
    if (!isim || !tür || isNaN(stok)) {
      alert('Lütfen tüm alanları doldurun ve stok sayılarını doğru girin.');
      return;
    }
    const varMi = kayıtlar.some(k => k.isim.toLowerCase() === isim.toLowerCase() && k.tür.toLowerCase() === tür.toLowerCase());
    if (varMi) {
      alert('Bu kayıt zaten var. Güncellemek için stok güncelleme yapabilirsiniz.');
      return;
    }
    const bugun = new Date();
    const gun = bugun.getDate().toString().padStart(2,'0');
    const ay = (bugun.getMonth()+1).toString().padStart(2,'0');
    const yil = bugun.getFullYear();
    const stokGelisTarihi = `${yil}-${ay}-${gun}`;

    kayıtlar.push({ 
      isim, 
      tür, 
      stok, 
      girisTarihi: '', 
      bitisTarihi: '', 
      stokGelis: stokGelisTarihi
    });
    localStorage.setItem('kayıtlar', JSON.stringify(kayıtlar));
    document.getElementById('isim').value = '';
    document.getElementById('tür').value = '';
    document.getElementById('stok').value = '';

    filtrele();
  }

  function filtrele() {
    const isimFiltre = document.getElementById('filtreIsim').value.toLowerCase();
    const türFiltre = document.getElementById('filtreTür').value.toLowerCase();
    const tarihFiltre = document.getElementById('filtreTarih').value; // format: yyyy-mm-dd

    let filtered = kayıtlar.filter(k => {
      const isimMatch = k.isim.toLowerCase().includes(isimFiltre);
      const türMatch = k.tür.toLowerCase().includes(türFiltre);
      
      let tarihMatch = true;
      if (tarihFiltre) {
        // Kontrol giriş tarihi veya bitiş tarihi veya stokGelis
        const girişTarih = k.girisTarihi;
        const bitişTarih = k.bitisTarihi;
        const stokGelisTarihi = k.stokGelis;

        // En uygun tarihi seç
        const tarihler = [girişTarih, bitişTarih, stokGelisTarihi].filter(t => t);
        // Kontrol edilen tarih, en az birine uyuyorsa
        tarihMatch = tarihler.some(t => t.startsWith(tarihFiltre));
      }
      
      return isimMatch && türMatch && tarihMatch;
    });
    göster(filtered);
  }

  window.onload = başlangıç;
</script>

</body>
</html>
